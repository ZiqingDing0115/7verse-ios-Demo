# 1.2 åç«¯é“¾è·¯ï¼ˆæ–°æµç¨‹ - Prompt ä¼˜åŒ–ç‰ˆï¼‰

## ç›®æ ‡
æœ¬ Demo ä¸“æ³¨äºå‰ç«¯æµç¨‹è·‘é€šå’Œ **Prompt æ•ˆæœéªŒè¯ä¼˜åŒ–**ï¼Œæš‚ä¸æ¶‰åŠç¤¾åŒºå‘å¸ƒç­‰ä¸šåŠ¡åŠŸèƒ½ã€‚

---

## æ ¸å¿ƒæµç¨‹è¡¨æ ¼

| æ­¥éª¤ | ç›®çš„ï¼šè·å–CVIçš„å“ªäº›ç‰©æ–™ | ç”¨æˆ·æ“ä½œ/è¾“å…¥ | æœåŠ¡ç«¯çš„è°ƒåº¦ | éœ€è¦çš„åŸå­æ¥å£ | äº¤ä»˜å­—æ®µ |
|------|------------------------|--------------|-------------|---------------|----------|
| **æ‹ç…§/ä¸Šä¼ ** | è·å–é¦–é¡¶å›¾ | ç›´æ¥æ‹ä¸€å¼ ç…§ï¼Œæˆ–è€…ä»æ‰‹æœºç›¸å†Œé€‰å–å›¾ç‰‡ä¸Šä¼  | â€¢ åŸºäºç”¨æˆ·å›¾ç‰‡å‚è€ƒç”Ÿæˆé¦–é¡¶å›¾<br>â€¢ **[æ–°å¢]** ä½¿ç”¨ LLM Vision åˆ†æå›¾ç‰‡ç‰¹å¾<br>â€¢ **[æ–°å¢]** AI æ¨è 7 ä¸ªæ ‡ç­¾ | â€¢ **Stable Diffusion å›¾ç”Ÿå›¾**ï¼ˆæˆ– Seedreamï¼‰<br>â€¢ **[P1] GPT-4 Vision å›¾åƒåˆ†æ**<br>â€¢ **[P1] LLM ç”Ÿæˆæ ‡ç­¾æ¨è prompt** | â€¢ [ä¸­é—´å­—æ®µ] user_upload_image<br>â€¢ **[æ–°å¢]** recommended_tags<br>â€¢ **[æ–°å¢]** image_analysis |
| **æ ‡ç­¾é€‰æ‹©** | å®Œå–„äººæ ¼ Personality | ç”¨æˆ·ä»æ¨èæ ‡ç­¾ä¸­é€‰æ‹©ï¼Œæˆ–æ‰‹åŠ¨æ·»åŠ æ ‡ç­¾ | â€¢ **è°ƒç”¨ AI åˆ†æå›¾ç‰‡ç‰¹å¾ï¼Œæ¨èæ ‡ç­¾**<br>â€¢ ç”¨æˆ·ç¡®è®¤/ä¿®æ”¹æ ‡ç­¾<br>â€¢ **[æ–°å¢]** ç”Ÿæˆ 4 ç§é£æ ¼çš„ img2img prompts | â€¢ **[P0] GPT-4 Vision æ ‡ç­¾æ¨è**<br>â€¢ **[P0] LLM ç”Ÿæˆ 4 ä¸ªé£æ ¼ prompt**<br>â€¢ æ ‡ç­¾åº“ç®¡ç†ï¼ˆå‰ç«¯/åç«¯ï¼‰ | â€¢ [ä¸­é—´å­—æ®µ] selected_tags<br>â€¢ **[æ–°å¢]** style_prompts (4ä¸ª)<br>â€¢ **[æ–°å¢]** tag_analysis |
| **é£æ ¼å›¾é€‰æ‹©** | è·å–æœ€ç»ˆå›¾ç‰‡ | ç”¨æˆ·ä» 4 å¼ é£æ ¼å›¾ä¸­é€‰æ‹© 1 å¼  | â€¢ **å¹¶è¡Œç”Ÿæˆ 4 å¼ é£æ ¼å›¾**<br>â€¢ æ˜¾ç¤ºç”Ÿæˆæ—¶é—´<br>â€¢ **[æ–°å¢]** åŸºäºå›¾ç‰‡å’Œæ ‡ç­¾æ¨èéŸ³è‰² | â€¢ **[P0] Stable Diffusion img2img**ï¼ˆ4æ¬¡è°ƒç”¨ï¼‰<br>â€¢ **[P1] GPT-4 Vision éŸ³è‰²æ¨è**<br>â€¢ éŸ³è‰²åº“æŸ¥è¯¢ | â€¢ [ä¸­é—´å­—æ®µ] generated_images (4å¼ )<br>â€¢ **[æ–°å¢]** selected_image_index<br>â€¢ **[æ–°å¢]** recommended_voice_id<br>â€¢ **[æ–°å¢]** generation_time |
| **éŸ³è‰²é€‰æ‹©** | è·å–éŸ³é¢‘ | ç”¨æˆ·é€‰æ‹©æ¨èéŸ³è‰²æˆ–ä»éŸ³è‰²åº“é€‰æ‹© | â€¢ æ˜¾ç¤ºæ¨èéŸ³è‰²<br>â€¢ æä¾›éŸ³è‰²åº“æµè§ˆ<br>â€¢ **[å¯é€‰]** ç”Ÿæˆè¯•å¬éŸ³é¢‘ | â€¢ **[P1] éŸ³è‰²åº“æŸ¥è¯¢**<br>â€¢ **[å¯é€‰]** TTS è¯•å¬ç”Ÿæˆ | â€¢ [ä¸­é—´å­—æ®µ] selected_voice_id<br>â€¢ **[å¯é€‰]** voice_preview_URL |
| **é¢„è§ˆ** | å±•ç¤ºæœ€ç»ˆæ•ˆæœ | é¢„è§ˆï¼šæ— éœ€æ“ä½œ<br><br>**[ç®€åŒ–ç‰ˆ]** ä»…å±•ç¤ºå›¾ç‰‡+ä¿¡æ¯<br>**[å®Œæ•´ç‰ˆ]** ç”Ÿæˆä¸€æ®µæœ‰æ„æ€ã€æœ‰ä¸€å®šä¼ æ’­æ€§çš„è§†é¢‘ | â€¢ è¿”å›é¢„è§ˆæ•°æ®<br>â€¢ **[å¯é€‰]** ç”Ÿæˆé¢„è§ˆè§†é¢‘<br>â€¢ **[å¯é€‰]** LLM ç”Ÿæˆ title/description | â€¢ **[å¯é€‰]** D-ID / HeyGen è§†é¢‘ç”Ÿæˆ<br>â€¢ **[å¯é€‰]** LLM ç”Ÿæˆæ–‡æ¡ˆ | â€¢ **[ç®€åŒ–ç‰ˆ]** preview_data (å›¾ç‰‡+æ ‡ç­¾+éŸ³è‰²)<br>â€¢ **[å®Œæ•´ç‰ˆ]** preview_video_URL<br>â€¢ **[å¯é€‰]** generated_title<br>â€¢ **[å¯é€‰]** generated_description |

---

## ğŸ”„ ä¸æ—§æµç¨‹å¯¹æ¯”

### âœ… ä¿ç•™çš„æŠ€æœ¯æ¥å£
1. **å›¾ç”Ÿå›¾æœåŠ¡**ï¼šSeedream â†’ Stable Diffusion / Replicate
2. **LLM Prompt ç”Ÿæˆ**ï¼šç³»ç»Ÿ prompt è°ƒç”¨
3. **éŸ³è‰²è¯†åˆ«/æ¨è**ï¼šåŸºäºå›¾ç‰‡ç‰¹å¾åŒ¹é…éŸ³è‰²
4. **è§†é¢‘ç”Ÿæˆ**ï¼ˆå¯é€‰ï¼‰ï¼šD-ID / HeyGen

### âŒ å»æ‰çš„ä¸šåŠ¡æ¥å£
1. ~~CVI Post æ³¨å†Œ~~ï¼ˆä¸éœ€è¦ç¤¾åŒºåŠŸèƒ½ï¼‰
2. ~~ç¤¾åŒºå‘å¸ƒ~~ï¼ˆä¸éœ€è¦å‘å¸ƒåˆ°ç¤¾åŒºï¼‰
3. ~~å¼‚æ­¥å›è°ƒ~~ï¼ˆç®€åŒ–ä¸ºåŒæ­¥ç­‰å¾…ï¼‰
4. ~~éŸ³è‰²ä¸Šä¼ /å…‹éš†~~ï¼ˆæ”¹ä¸ºé€‰æ‹©é¢„è®¾éŸ³è‰²ï¼‰
5. ~~Tap to speak è¾“å…¥~~ï¼ˆå»æ‰æ–‡æœ¬è¾“å…¥æ­¥éª¤ï¼‰

### ğŸ†• æ–°å¢çš„åŠŸèƒ½
1. **AI æ ‡ç­¾æ¨è**ï¼ˆåŸºäºå›¾ç‰‡è‡ªåŠ¨æ¨èï¼‰
2. **4 ç§é£æ ¼å›¾ç”Ÿæˆ**ï¼ˆå¹¶è¡Œç”Ÿæˆï¼Œç”¨æˆ·é€‰æ‹©ï¼‰
3. **éŸ³è‰²æ™ºèƒ½æ¨è**ï¼ˆåŸºäºå›¾ç‰‡å’Œæ ‡ç­¾ï¼‰
4. **æ€§èƒ½ç›‘æ§**ï¼ˆè®°å½•æ¯æ­¥è€—æ—¶ï¼‰

---

## ğŸ“Š å…³é”®æŠ€æœ¯å†³ç­–

### 1. å›¾ç”Ÿå›¾æ–¹æ¡ˆ
**é€‰é¡¹**ï¼š
- **æ–¹æ¡ˆ A**ï¼šStable Diffusion + Replicate APIï¼ˆæ¨èï¼‰
  - é€Ÿåº¦ï¼š2-4 ç§’/å¼ 
  - æˆæœ¬ï¼š$0.005/å¼ 
  - å¹¶è¡Œç”Ÿæˆ 4 å¼ ï¼šçº¦ 3-5 ç§’
  
- **æ–¹æ¡ˆ B**ï¼šç»§ç»­ä½¿ç”¨ Seedreamï¼ˆå¦‚æœå…¬å¸å†…éƒ¨æœ‰ï¼‰
  - éœ€è¦ç¡®è®¤æ˜¯å¦æ”¯æŒè‡ªå®šä¹‰ prompt
  - éœ€è¦ç¡®è®¤æ˜¯å¦æ”¯æŒå¹¶è¡Œè°ƒç”¨

**å†³ç­–**ï¼šä¼˜å…ˆ Replicate SDXL Turboï¼Œæµ‹è¯•åå†å†³å®š

---

### 2. æ ‡ç­¾æ¨èæ–¹æ¡ˆ
**æŠ€æœ¯æ ˆ**ï¼šGPT-4 Vision API

**Prompt**ï¼š
```
åˆ†æå›¾ç‰‡ â†’ è¯†åˆ«äººç‰©ç‰¹å¾ã€é£æ ¼ã€æƒ…ç»ª â†’ ä»æ ‡ç­¾åº“åŒ¹é… 7 ä¸ªæ ‡ç­¾
```

**è¾“å…¥**ï¼š
- å›¾ç‰‡ base64
- æ ‡ç­¾åº“ï¼ˆPersona + Relationshipï¼‰

**è¾“å‡º**ï¼š
```json
["Adventurous", "Social butterfly", "Cinematic", ...]
```

---

### 3. é£æ ¼å›¾ç”Ÿæˆæ–¹æ¡ˆ
**æŠ€æœ¯æ ˆ**ï¼šGPT-4 + Stable Diffusion

**æµç¨‹**ï¼š
```
ç”¨æˆ·é€‰æ‹©æ ‡ç­¾ â†’ GPT-4 ç”Ÿæˆ 4 ä¸ªé£æ ¼ prompt â†’ SD å¹¶è¡Œç”Ÿæˆ 4 å¼ å›¾
```

**Prompt**ï¼š
```
åŸºäºæ ‡ç­¾å’ŒåŸå›¾ â†’ ç”Ÿæˆ 4 ç§ä¸åŒé£æ ¼çš„ img2img prompt
(Variant 1: å†™å®, Variant 2: è‰ºæœ¯, Variant 3: ç”µå½±, Variant 4: åˆ›æ„)
```

**å¹¶è¡Œä¼˜åŒ–**ï¼š
```javascript
const images = await Promise.all(
  prompts.map(p => generateImage(p))
);
```

---

### 4. éŸ³è‰²æ¨èæ–¹æ¡ˆ
**æŠ€æœ¯æ ˆ**ï¼šGPT-4 Vision + éŸ³è‰²åº“åŒ¹é…

**Prompt**ï¼š
```
åˆ†æå›¾ç‰‡+æ ‡ç­¾ â†’ æ¨æ–­äººç‰©æ€§æ ¼ â†’ åŒ¹é…éŸ³è‰²åº“ â†’ æ¨èæœ€ä½³éŸ³è‰²
```

**éŸ³è‰²åº“ç»“æ„**ï¼š
```json
{
  "id": "lively-woman",
  "name": "Lively woman",
  "gender": "Female",
  "tags": ["Energetic", "Friendly"],
  "description": "..."
}
```

---

## ğŸ¯ æ¥å£è®¾è®¡ï¼ˆç®€åŒ–ç‰ˆï¼‰

### API 1: æ ‡ç­¾æ¨è
```
POST /api/recommend-tags

Request:
{
  "image": "base64..."
}

Response:
{
  "success": true,
  "recommended_tags": ["Tag1", "Tag2", ...],
  "reasoning": "åŸºäºå›¾ç‰‡åˆ†æ...",
  "duration": "2.3s"
}
```

---

### API 2: ç”Ÿæˆé£æ ¼å›¾
```
POST /api/generate-style-images

Request:
{
  "source_image": "base64...",
  "selected_tags": ["Tag1", "Tag2"]
}

Response:
{
  "success": true,
  "prompts": ["prompt1", "prompt2", "prompt3", "prompt4"],
  "images": [
    {"url": "...", "style": "realistic"},
    {"url": "...", "style": "artistic"},
    {"url": "...", "style": "cinematic"},
    {"url": "...", "style": "creative"}
  ],
  "total_time": "5.2s",
  "individual_times": ["1.2s", "1.3s", "1.4s", "1.3s"]
}
```

---

### API 3: æ¨èéŸ³è‰²
```
POST /api/recommend-voice

Request:
{
  "image": "base64...",
  "selected_tags": ["Tag1", "Tag2"]
}

Response:
{
  "success": true,
  "recommended_voice": {
    "id": "lively-woman",
    "name": "Lively woman",
    "reasoning": "..."
  },
  "duration": "1.1s"
}
```

---

### API 4: é¢„è§ˆï¼ˆç®€åŒ–ç‰ˆï¼‰
```
POST /api/preview

Request:
{
  "image_url": "...",
  "voice_id": "lively-woman",
  "tags": [...]
}

Response:
{
  "success": true,
  "preview_data": {
    "image": "...",
    "voice": {...},
    "tags": [...],
    "generated_title": "...",  // å¯é€‰
    "generated_description": "..."  // å¯é€‰
  }
}
```

---

## ğŸ”§ æŠ€æœ¯å®ç°è¦ç‚¹

### 1. å¹¶è¡Œå¤„ç†ï¼ˆæå‡é€Ÿåº¦ï¼‰
```javascript
// âŒ ä¸²è¡Œï¼ˆæ…¢ï¼‰
const tags = await recommendTags(image);
const prompts = await generatePrompts(image, tags);
const images = await generateImages(prompts);  // 20ç§’

// âœ… å¹¶è¡Œï¼ˆå¿«ï¼‰
const images = await Promise.all([
  generateImage(prompts[0]),
  generateImage(prompts[1]),
  generateImage(prompts[2]),
  generateImage(prompts[3]),
]);  // 5ç§’
```

### 2. å‰ç«¯åŠ è½½çŠ¶æ€
```javascript
// æ˜¾ç¤ºè¿›åº¦
"æ­£åœ¨ç”Ÿæˆç¬¬ 1/4 å¼ å›¾ç‰‡..."
"æ­£åœ¨ç”Ÿæˆç¬¬ 2/4 å¼ å›¾ç‰‡..."
...
"å®Œæˆï¼æ€»è€—æ—¶: 5.2s"
```

### 3. é”™è¯¯å¤„ç†
```javascript
try {
  const result = await generateImages();
} catch (error) {
  // æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯æç¤º
  showError('ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•');
}
```

---

## ğŸ“ˆ æ€§èƒ½ç›®æ ‡

| æ­¥éª¤ | ç›®æ ‡æ—¶é—´ | å®é™…æµ‹è¯• | å¤‡æ³¨ |
|------|---------|---------|------|
| æ ‡ç­¾æ¨è | < 3s | ___ | GPT-4 Vision |
| ç”Ÿæˆ 4 ä¸ª prompts | < 2s | ___ | GPT-4 |
| å¹¶è¡Œç”Ÿæˆ 4 å¼ å›¾ | < 5s | ___ | SDXL Turbo |
| éŸ³è‰²æ¨è | < 2s | ___ | GPT-4 Vision |
| **æ€»æµç¨‹** | **< 15s** | ___ | ç›®æ ‡ |

---

## ğŸ’° æˆæœ¬ä¼°ç®—ï¼ˆå•æ¬¡æµç¨‹ï¼‰

| æœåŠ¡ | è°ƒç”¨æ¬¡æ•° | å•ä»· | å°è®¡ |
|------|---------|------|------|
| GPT-4 Visionï¼ˆæ ‡ç­¾ï¼‰ | 1 | $0.02 | $0.02 |
| GPT-4ï¼ˆpromptsï¼‰ | 1 | $0.01 | $0.01 |
| SDXL Turboï¼ˆ4å¼ ï¼‰ | 4 | $0.005 | $0.02 |
| GPT-4 Visionï¼ˆéŸ³è‰²ï¼‰ | 1 | $0.02 | $0.02 |
| **æ€»è®¡** | - | - | **$0.07 â‰ˆ Â¥0.5** |

20å…ƒé¢„ç®— = **40 æ¬¡å®Œæ•´æµç¨‹æµ‹è¯•**

---

## ğŸš€ å®æ–½ä¼˜å…ˆçº§

### P0ï¼ˆå¿…é¡»ï¼‰
- [x] æ‹ç…§/ä¸Šä¼ åŠŸèƒ½
- [x] æ ‡ç­¾é€‰æ‹© UI
- [ ] **AI æ ‡ç­¾æ¨èé›†æˆ**
- [ ] **å›¾ç”Ÿå›¾ API é›†æˆ**
- [x] é£æ ¼å›¾é€‰æ‹© UI
- [x] éŸ³è‰²é€‰æ‹© UI
- [x] é¢„è§ˆé¡µé¢

### P1ï¼ˆé‡è¦ï¼‰
- [ ] **éŸ³è‰²æ¨èé›†æˆ**
- [ ] æ€§èƒ½ç›‘æ§é¢æ¿
- [ ] é”™è¯¯å¤„ç†ä¼˜åŒ–
- [ ] **Prompt æ•ˆæœè¯„æµ‹**

### P2ï¼ˆå¯é€‰ï¼‰
- [ ] è§†é¢‘ç”Ÿæˆ
- [ ] æ–‡æ¡ˆç”Ÿæˆ
- [ ] éŸ³è‰²è¯•å¬
- [ ] æ•°æ®å¯¼å‡º

---

## ğŸ“ Prompt ç®¡ç†

æ‰€æœ‰ Prompt å·²ä¿å­˜åœ¨ï¼š
- `src/config/prompts-library.js`

**ç‰ˆæœ¬æ§åˆ¶**ï¼š
- æ¯æ¬¡ä¼˜åŒ– Prompt åæ›´æ–°ç‰ˆæœ¬å·
- è®°å½•æµ‹è¯•æ•ˆæœå’Œæ”¹è¿›ç‚¹
- å¯¹æ¯”ä¸åŒç‰ˆæœ¬çš„ç”Ÿæˆè´¨é‡

**æµ‹è¯•æµç¨‹**ï¼š
1. ä½¿ç”¨ç›¸åŒæµ‹è¯•å›¾ç‰‡
2. è®°å½•ç”Ÿæˆç»“æœ
3. è¯„åˆ†ï¼ˆ1-10ï¼‰
4. è®°å½•åˆ°è¯„æµ‹è¡¨
5. é€‰æ‹©æœ€ä¼˜ç‰ˆæœ¬

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. âœ… å®Œæˆå‰ç«¯ UIï¼ˆå·²å®Œæˆï¼‰
2. â³ é›†æˆ Replicate APIï¼ˆå¾…ä½ æä¾› Keyï¼‰
3. â³ é›†æˆ OpenAI GPT-4 Visionï¼ˆå¾…ä½ æä¾› Keyï¼‰
4. â³ æµ‹è¯•å®Œæ•´æµç¨‹
5. â³ ä¼˜åŒ– Prompt
6. â³ æ€§èƒ½è¯„æµ‹

---

## ğŸ’¡ å…³é”®å·®å¼‚æ€»ç»“

| é¡¹ç›® | æ—§æµç¨‹ | æ–°æµç¨‹ | å˜åŒ–åŸå›  |
|------|-------|--------|----------|
| **æ ¸å¿ƒç›®æ ‡** | åˆ›å»ºè§’è‰² + ç¤¾åŒºå‘å¸ƒ | **Prompt æµ‹è¯•å’Œä¼˜åŒ–** | èšç„¦æ ¸å¿ƒéªŒè¯ |
| **æ­¥éª¤æ•°** | 4 æ­¥ | 4 æ­¥ | ç›¸åŒ |
| **éŸ³è‰²** | ç”¨æˆ·ä¸Šä¼ /å½•åˆ¶ | **AI æ¨è** + é€‰æ‹© | ç®€åŒ–æµç¨‹ |
| **äººè®¾** | ç”¨æˆ·è¾“å…¥æ–‡æœ¬ | **é€‰æ‹©æ ‡ç­¾** | é™ä½é—¨æ§› |
| **å›¾ç‰‡** | 1 å¼  | **4 å¼ é£æ ¼** | å¢åŠ é€‰æ‹©æ€§ |
| **å‘å¸ƒ** | ç¤¾åŒºå‘å¸ƒ | ä»…é¢„è§ˆ | å»æ‰ä¸šåŠ¡é€»è¾‘ |
| **é‡ç‚¹** | å®Œæ•´äº§å“ | **AI æ•ˆæœæµ‹è¯•** | ç›®æ ‡ä¸åŒ |

---

**æ€»ç»“**ï¼šæ–°æµç¨‹ä¿ç•™äº†æ‰€æœ‰é€šç”¨æŠ€æœ¯æ¥å£ï¼ˆå›¾ç”Ÿå›¾ã€LLMã€éŸ³è‰²ï¼‰ï¼Œå»æ‰äº†ä¸šåŠ¡æ¥å£ï¼ˆç¤¾åŒºã€å‘å¸ƒï¼‰ï¼Œæ–°å¢äº† AI æ¨èå’Œå¤šé£æ ¼ç”Ÿæˆï¼Œæ›´é€‚åˆ Prompt ä¼˜åŒ–éªŒè¯ï¼ğŸ¯
